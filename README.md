# vocoder 


Детектирование голоса в базе данных:

Голос1  =  аудио V1
Голос2  =  аудио V2
Голос3  =  аудио V3
...

исследкемый голос  = аудио V

Алгоритм детектирования:

V1 -> вектор PCM моно 8КГц 16бит v1 
V2 -> вектор PCM моно 8КГц 16бит v2
V3 -> вектор PCM моно 8КГц 16бит v3
...
V -> вектор PCM моно 8КГц 16бит v


вектор PCM моно 8КГц 16бит -> нарезаем на блоки по 1024 элемнтов типа double (d1,d2,...) -> каждый блок из 1024 элементов пропускаем через преобразование Фурье из библиотеки FFTW , полученный вектор комплексных чисел от каждого числа берём амплитуду, то есть получаем опять действительнык числа (использовать комплексные не обызательно, просто не было времени разбираться с библиотекой) -> все поллученные ветрора амплитуд из 1024 элементом комбинируем в один ветор максимальных значений по каждой позиции и нормируем вектор по средней квадратичной - то есть получаем нормированную функцию огибающую верхние границы спектра голоса
полученная функция огибающая верхние границы спектра голоса является индивидуальным призенаком ЧЕЛОВЕКА или КЛАССИЧЕСКОГО МУЗЫКАЛЬНОГО ИНСТРУМЕНТА (не синтезатора)

вектор PCM моно 8КГц 16бит v1 -> вектор 1024 элементов функция огибающей верхние границы спектра s1
вектор PCM моно 8КГц 16бит v2 -> вектор 1024 элементов функция огибающей верхние границы спектра s2
вектор PCM моно 8КГц 16бит v3 -> вектор 1024 элементов функция огибающей верхние границы спектра s3
...
вектор PCM моно 8КГц 16бит v -> вектор 1024 элементов функция огибающей верхние границы спектра s

вычислем коллеляции
corr(s,s1)
corr(s,s2)
corr(s,s3)
...


при этом просто ради изврата пользуемся FFTW
См Википедиа: свертка f*g (x)=Sf(x-t)g(t)dt == REVFFT(FFT(f)xFFT(g))
Изврат при подсчёте корреляции
corr(s,si) = Abs(REVFFT(FFT(перевернуть s)xFFT(si))(0))

тот голос для которого значение корреляции corr(s,si) максимально считаем за результат детектирования предъявленного образца
хотя надп эксперементальным путём определить когда образец вообще не соответствует ни одному голосу в базе


Этап 2
Попытка детектирования сказанного
При исследовании сказанного исследуется не частотные характеристики а функция огибающая амплитуду звука

Сказанное1  =  аудио V1
Сказанное2  =  аудио V2
Сказанное3  =  аудио V3
...

исследкемый сказанное  = аудио V
Чтобы сократить время вычислений то в реализации сравнивается только с голосом из базы данных найденном на предыдущем этапе

V1 -> вектор PCM моно 8КГц 16бит v1 длительности 1,5 сек дополняя тишиной если короче - вектор заменяется на Abs значения - нормируем по среднеквадратичной вектор v1
V2 -> вектор PCM моно 8КГц 16бит v2 длительности 1,5 сек дополняя тишиной если короче - вектор заменяется на Abs значения - нормируем по среднеквадратичной вектор v2
V3 -> вектор PCM моно 8КГц 16бит v3 длительности 1,5 сек дополняя тишиной если короче - вектор заменяется на Abs значения - нормируем по среднеквадратичной вектор v2
...
V -> вектор PCM моно 8КГц 16бит v длительности 1,5 сек дополняя тишиной если короче - вектор заменяется на Abs значения - нормируем по среднеквадратичной вектор v


Массив фонем - за не имением иного берём биграммы латинского алфавита и пропускаем через синтезатор речи Windows

AA -> вектор PCM моно 8КГц 16бит s1 длительности 1,5 сек дополняя тишиной если короче - вектор заменяется на Abs значения
AB -> вектор PCM моно 8КГц 16бит s2 длительности 1,5 сек дополняя тишиной если короче - вектор заменяется на Abs значения
..
ZZ -> вектор PCM моно 8КГц 16бит sk длительности 1,5 сек дополняя тишиной если короче - вектор заменяется на Abs значения

Вычисляем вектора
Abs(REVFFT(FFT(vi)xFFT(перевернуть sj)))
полученные вектора показывают корелляцию при размещении фонемы sj в векторек vi с заданным смещением по времени
исследовать временные смещения - более сложная программная реализация - поэтому из из массива Abs(REVFFT(FFT(vi)xFFT(перевернуть sj))) берём только максимальное значение

для каждого vi находим 7 фонем, кототорые имеют максимальную корреляцию с данным сказанным

то же проделываем и с предъявленным голосом

Если 7 фонем для исследуемого сказанного совпали с 7-ью фонемами сказанного в базе данных то считаем что сказанно одно и тоже










